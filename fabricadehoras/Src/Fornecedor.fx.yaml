Fornecedor As screen:
    BackgroundImage: ='MicrosoftTeams-image'
    LoadingSpinnerColor: =RGBA(56, 96, 178, 1.5)
    OnVisible: =Set(vTabMenu,"Tab1")

    SideMenu_1 As SideMenu:

    gal_valores As gallery.variableTemplateHeightGallery:
        DelayItemLoading: =true
        Height: =470
        Items: |-
            =clc_group_msl
            //clc_tabela1
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplatePadding: =4
        TemplateSize: =206
        Width: =1758
        X: =136
        Y: =492
        ZIndex: =2

        Label3 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: =ThisItem.id_fabrica
            Width: =126.5
            X: =47
            ZIndex: =1

        Label3_1 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =50
            OnSelect: =Select(Parent)
            Overflow: =Overflow.Scroll
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =15
            Text: =ThisItem.descricao
            VerticalAlign: =VerticalAlign.Top
            Width: =570.66
            X: =182.72
            ZIndex: =2

        Label3_2 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: =ThisItem.ano_consumo
            Width: =94.17
            X: =753.38
            ZIndex: =3

        Label3_3 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: =ThisItem.mes_inicio
            Width: =87.14
            X: =865.83
            ZIndex: =4

        Label3_4 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: =ThisItem.qtd_meses
            Width: =101.2
            X: =952.97
            ZIndex: =5

        Label3_5 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: =ThisItem.total_baseline
            Width: =180
            X: =1054.17
            ZIndex: =6

        Label3_6 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: |-
                =Text(Value(ThisItem.valor_contratao),"$#,##0.00","pt-BR")
            Width: =276
            X: =1234
            ZIndex: =7

        Label3_7 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            OnSelect: =Select(Parent)
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: |-
                =Text(Value(ThisItem.valor_unitario),"$#,##0.00","pt-BR")
            Width: =240
            X: =1510.98
            ZIndex: =8

        Icon2 As icon.ChevronDown:
            Height: =15
            Icon: |-
                =//Icon.ChevronDown
                If(varShowIdFab="0",Icon.ChevronRight,If(varShowIdFab=ThisItem.id_fabrica, Icon.ChevronDown, Icon.ChevronRight))
            OnSelect: |-
                =If(varShowIdFab = ThisItem.id_fabrica, 
                    UpdateContext({varShowIdFab:"0"}),
                    UpdateContext({varShowIdFab:ThisItem.id_fabrica, vAllitems:Blank(),vEdicaoItem:false})
                    //Set(varShowIdFab;ThisItem.id_fabrica)
                );
            Width: =21.08
            X: =9
            Y: =10
            ZIndex: =16

        Rectangle8 As rectangle:
            Fill: =RGBA(219, 219, 219, 1)
            Height: =1
            OnSelect: =
            Visible: =Switch(varShowIdFab,"0",false,ThisItem.id_fabrica,true)
            Width: =1676
            X: =47
            Y: =223
            ZIndex: =20

        galeria_expandida As gallery.galleryVertical:
            DelayItemLoading: =true
            Height: =162
            Items: =Filter(Sort(clc_tabela1,id,SortOrder.Descending), id_fabrica=ThisItem.id_fabrica)
            Layout: =Layout.Vertical
            LoadingSpinner: =LoadingSpinner.Data
            TemplateSize: =55
            Visible: =Switch(varShowIdFab,"0",false,ThisItem.id_fabrica,true)
            Width: =1668
            X: =40
            Y: =35
            ZIndex: =21

            Label11 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Height: =50
                Italic: =true
                OnSelect: =Select(Parent)
                Overflow: =Overflow.Scroll
                Size: =14
                Text: =ThisItem.descricao
                VerticalAlign: =VerticalAlign.Top
                Width: =570
                X: =140
                ZIndex: =1

            Icon3_5 As icon.Trash:
                Height: =20
                Icon: =Icon.Trash
                OnSelect: |-
                    =UpdateContext({vShowConfExclusaoItem:true, id_sel: ThisItem.id})
                Width: =25
                X: =13
                Y: =16
                ZIndex: =2

            Image4_5 As image:
                Height: =20
                Image: =compose
                OnSelect: |-
                    =UpdateContext({vShowEdicao:true})
                Width: =25
                X: =41
                Y: =16
                ZIndex: =3

            Label11_1 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =14
                Text: =ThisItem.ano_consumo
                Width: =76
                X: =723
                ZIndex: =4

            Label11_2 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =14
                Text: =ThisItem.mes_inicio
                Width: =63
                X: =824
                ZIndex: =5

            Label11_3 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =14
                Text: =ThisItem.qtd_meses
                Width: =64
                X: =916
                ZIndex: =6

            Label11_4 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =14
                Text: =ThisItem.total_baseline
                Width: =131
                X: =1010
                ZIndex: =7

            Label11_5 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =14
                Text: |-
                    =Text(Value(ThisItem.valor_contratao),"$#,##0.00","pt-BR")
                Width: =224
                X: =1195
                ZIndex: =8

            Label11_6 As label:
                Font: =Font.Lato
                FontWeight: =FontWeight.Semibold
                Italic: =true
                OnSelect: =Select(Parent)
                Size: =14
                Text: |-
                    =Text(Value(ThisItem.valor_unitario),"$#,##0.00","pt-BR")
                Width: =184
                X: =1460
                ZIndex: =9

            Button2 As button:
                BorderThickness: =0
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =20
                HoverColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(56, 96, 178, 0)
                OnSelect: |-
                    =UpdateContext({
                    vAllitems: ThisItem,
                    vEdicaoItem:true
                    })
                PressedFill: =
                RadiusBottomLeft: =1
                RadiusBottomRight: =1
                RadiusTopLeft: =1
                RadiusTopRight: =1
                Text: =""
                Width: =20
                X: =45
                Y: =16
                ZIndex: =10

            Image2 As image:
                Height: =25
                Image: ='botao-adicionar'
                OnSelect: =Select(Parent)
                Width: =25
                X: =70
                Y: =13
                ZIndex: =11

            Button2_1 As button:
                BorderThickness: =0
                DisabledColor: =RGBA(0, 0, 0, 0)
                DisabledFill: =RGBA(0, 0, 0, 0)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =20
                HoverColor: =RGBA(0, 0, 0, 0)
                HoverFill: =RGBA(56, 96, 178, 0)
                OnSelect: |-
                    =UpdateContext({
                    vLinhaSelecionada: ThisItem,
                    vShowMensalizacao:true
                    })
                PressedFill: =
                RadiusBottomLeft: =1
                RadiusBottomRight: =1
                RadiusTopLeft: =1
                RadiusTopRight: =1
                Text: =""
                Width: =20
                X: =72
                Y: =16
                ZIndex: =12

    Label1 As label:
        Color: =ColorValue(vTitFontColor)  
        Font: =vTitFontFamily
        FontWeight: =vTitFontWeightB
        Height: =66
        PaddingLeft: =15
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =42.17
        Text: ="[Fábrica de Horas] Cadastro Consumo"
        Width: =1807.55
        X: =112.45
        ZIndex: =3

    barra_navegacao_1 As barra_navegacao:
        acaoFornecedor: =Fornecedor
        acaoGestor: =Gestor
        acaoLista: =Lista
        Width: =899.56
        X: =112.45
        Y: =64
        ZIndex: =4

    Rectangle4 As rectangle:
        Fill: =RGBA(248, 248, 248, 1)
        Height: =170
        Width: =1807.55
        X: =112.45
        Y: =155
        ZIndex: =5

    Group4 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        cmb_head As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["cr274_nome"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            Items: =Filter(tb_areass, CO_AREA= cmb_area.Selected.CO_AREA)
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["cr274_nome"]
            SearchItems: =Search(Filter(tb_areass, CO_AREA= cmb_area.Selected.CO_AREA),cmb_head.SearchText,"cr274_nome")
            SelectMultiple: =false
            Size: =18.27
            Width: =423.07
            X: =563.63
            Y: =192
            ZIndex: =8

        Icon1_1 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =573.47
            Y: =201
            ZIndex: =9

        Label2_1 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Head"
            Width: =380.91
            X: =562.23
            Y: =161
            ZIndex: =15

    Group3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        cmb_area As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["cr274_no_area"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            IsSearchable: =false
            Items: =tb_areass
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["cr274_no_area"]
            SearchItems: =[]
            SelectMultiple: =false
            Size: =18.27
            Width: =379.5
            X: =130.72
            Y: =192
            ZIndex: =6

        Icon1 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =140.56
            Y: =201
            ZIndex: =7

        Label2 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Área"
            Width: =379.5
            X: =130.72
            Y: =161
            ZIndex: =14

    Group5 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        cmb_no_area As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["cr274_nome"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            Items: =Filter(tb_perfiss, CO_AREA = cmb_head.Selected.CO_AREA)
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["cr274_nome"]
            SearchItems: =Search(Filter(tb_perfiss, CO_AREA = cmb_head.Selected.CO_AREA),cmb_no_area.SearchText,"cr274_nome")
            SelectMultiple: =false
            Size: =18.27
            Width: =443
            X: =1019
            Y: =191
            ZIndex: =10

        Icon1_2 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =1028
            Y: =201
            ZIndex: =11

        Label2_2 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Gerência"
            Width: =380.91
            X: =1017
            Y: =160
            ZIndex: =16

    Group6 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =23

        cmb_co_area_lider_gestor As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["cr274_co_area"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            Items: =tb_perfiss
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["cr274_nome"]
            SearchItems: =Search(tb_perfiss,cmb_co_area_lider_gestor.SearchText,"cr274_nome")
            SelectMultiple: =false
            Size: =18.27
            Width: =379.5
            X: =1510.98
            Y: =191
            ZIndex: =12

        Icon1_3 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =1520.82
            Y: =201
            ZIndex: =13

        Label2_3 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Gestor"
            Width: =380.91
            X: =1509.58
            Y: =164
            ZIndex: =17

    Group3_1 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =26

        cmb_id_sequencial As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["cr274_no_sequencial"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            IsSearchable: =false
            Items: |-
                =//Distinct(clc_base_sequencial;sequencial_orcamento)
                tb_sequencials
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["cr274_nome"]
            SearchItems: =[]
            SelectMultiple: =false
            Size: =18.27
            Width: =379.5
            X: =130.72
            Y: =272
            ZIndex: =18

        Icon1_4 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =140.56
            Y: =281
            ZIndex: =19

        Label2_4 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Sequencial"
            Width: =379.5
            X: =130.72
            Y: =241
            ZIndex: =20

    linha As rectangle:
        Fill: =RGBA(219, 219, 219, 1)
        Height: =2
        Width: =1807.55
        X: =112.45
        Y: =332
        ZIndex: =27

    fundo As rectangle:
        Fill: =RGBA(248, 248, 248, 1)
        Height: =98
        Width: =1807.55
        X: =112.45
        Y: =336
        ZIndex: =28

    Group3_2 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =29

        ComboBox1_5 As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["Value"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            Items: =Distinct(clc_base_sequencial, nome_tag)
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["Value"]
            SearchItems: =Search(Distinct(clc_base_sequencial, nome_tag),ComboBox1_5.SearchText,"Value")
            SelectMultiple: =false
            Size: =18.27
            Width: =896.75
            X: =562.23
            Y: =272
            ZIndex: =21

        Icon1_5 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =572.06
            Y: =281
            ZIndex: =22

        Label2_5 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Descrição (Projeto Consolidado / Tag)"
            Width: =798.36
            X: =562.23
            Y: =241
            ZIndex: =23

    txt_descricao As text:
        BorderColor: =RGBA(128, 128, 128, 1)
        Default: =vAllitems.descricao
        Font: =Font.Lato
        Height: =72
        HintText: ="Descrição TI"
        Mode: =TextMode.MultiLine
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =15
        Width: =495
        X: =354.2
        Y: =349
        ZIndex: =31

    Group3_3 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =32

        cmb_id_fornecedor As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DisplayFields: =["cr274_no_fornecedor"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            Items: =tb_fornecedoress
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["cr274_nome"]
            SearchItems: =Search(tb_fornecedoress,cmb_id_fornecedor.SearchText,"cr274_nome")
            SelectMultiple: =false
            Size: =18.27
            Width: =379.5
            X: =1510.98
            Y: =275
            ZIndex: =24

        Icon1_6 As icon.Search:
            Color: =RGBA(128, 128, 128, 1)
            Height: =22
            Icon: =Icon.Search
            Width: =25.3
            X: =1520.82
            Y: =284
            ZIndex: =25

        Label2_6 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =31
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =16.87
            Text: ="Fornecedor"
            Width: =379.5
            X: =1510.98
            Y: =244
            ZIndex: =26

    Group3_4 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =36

        cmb_id_fabrica As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DefaultSelectedItems: =[vAllitems.id_fabrica]
            DisplayFields: =["id_fabrica"]
            Font: =Font.Lato
            Height: =39
            InputTextPlaceholder: =""
            Items: =clc_fabrica
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["id_fabrica"]
            SearchItems: =Search(clc_fabrica,cmb_id_fabrica.SearchText,"id_fabrica")
            SelectMultiple: =false
            Size: =18.27
            Width: =206.62
            X: =127.91
            Y: =378
            ZIndex: =29

        Label2_7 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =29
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: ="ID Fábrica"
            Width: =206.62
            X: =127.91
            Y: =340
            ZIndex: =30

    Group3_5 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =37

        cmb_ano_consumo As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DefaultSelectedItems: =[vAllitems.ano_consumo]
            DisplayFields: =["ano"]
            Font: =Font.Lato
            Height: =39
            InputTextPlaceholder: ="2023"
            Items: =clc_ano_consumo
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["ano"]
            SearchItems: =Search(clc_ano_consumo,cmb_ano_consumo.SearchText,"ano")
            SelectMultiple: =false
            Size: =14
            Width: =88
            X: =868
            Y: =380
            ZIndex: =32

        Label2_9 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =47
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: |-
                ="Ano 
                Consumo"
            Width: =118.07
            X: =849
            Y: =332
            ZIndex: =33

    Group3_6 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =40

        cmb_mes_consumo As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DefaultSelectedItems: =[vAllitems.mes_inicio]
            DisplayFields: =["mes"]
            Font: =Font.Lato
            InputTextPlaceholder: ="JAN"
            Items: =clc_mes_consumo
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["mes"]
            SearchItems: =Search(clc_mes_consumo,cmb_mes_consumo.SearchText,"mes")
            SelectMultiple: =false
            Size: =14
            Width: =80
            X: =972
            Y: =380
            ZIndex: =34

        Label2_10 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =43
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: |-
                ="Mês
                Consumo"
            Width: =126.5
            X: =948
            Y: =333
            ZIndex: =35

    btnAddFabrica As image:
        Height: =20
        Image: ='Button-mais'
        OnSelect: |-
            =UpdateContext({vShowAddFabrica:true})
        Width: =28.11
        X: =251.6
        Y: =346
        ZIndex: =42

    btnAdd As button:
        Fill: =RGBA(255, 0, 0, 1)
        FontWeight: =FontWeight.Bold
        OnSelect: |-
            =UpdateContext({vValidacao:true});
            
            If(IsBlank(cmb_id_fabrica.Selected.id_fabrica),UpdateContext({vValidacao:false}));
            If(IsBlank(txt_descricao.Text),UpdateContext({vValidacao:false}));
            If(IsBlank(cmb_ano_consumo.Selected.ano),UpdateContext({vValidacao:false}));
            If(IsBlank(cmb_mes_consumo.Selected.mes),UpdateContext({vValidacao:false}));
            If(IsBlank(txt_qtd_horas.Text),UpdateContext({vValidacao:false}));
            If(IsBlank(cmb_modelo_tarifacao.Selected.no_modelo),UpdateContext({vValidacao:false}));
            If(IsBlank(txt_valor_periodo.Text),UpdateContext({vValidacao:false}));
            
            If(vValidacao=true,
            
                Patch(clc_tabela1,
                    Defaults(clc_tabela1),
                    {
                        id: Last( SortByColumns( clc_tabela1, "id", SortOrder.Ascending )).id + 1,
                        id_fabrica: cmb_id_fabrica.Selected.id_fabrica,
                        descricao: txt_descricao.Text,
                        ano_consumo: cmb_ano_consumo.Selected.ano,
                        mes_inicio: cmb_mes_consumo.Selected.mes,
                        qtd_meses: Value(txt_qtd_horas.Text),
                        total_baseline: txt_baseline.Text,
                        valor_contratao: txt_valor_periodo.Text,
                        valor_unitario: Value(txt_valor_periodo.Text) / Value(txt_qtd_horas.Text),
                        co_area: cmb_area.Selected.CO_AREA,
                        co_lider_area: cmb_head.Selected.CO_LIDER_AREA,
                        no_area: cmb_no_area.Selected.NO_AREA,
                        co_lider_area_gestor: cmb_co_area_lider_gestor.Selected.CO_LIDER_AREA,
                        id_sequencial: cmb_id_sequencial.Selected.id,
                        id_fornecedor: cmb_id_fornecedor.Selected.id
                    }
                );
            
                Clear(clc_group_msl);
                ClearCollect(clc_group_msl,
                    AddColumns(
                            GroupBy(clc_tabela1, "id_fabrica","fabrica"),
                            "id",First(fabrica).id,
                            "descricao",First(fabrica).descricao,
                            "ano_consumo",First(fabrica).ano_consumo,
                            "mes_inicio",First(fabrica).mes_inicio,
                            "qtd_meses",First(fabrica).qtd_meses,
                            "total_baseline",First(fabrica).total_baseline,
                            "valor_contratao",First(fabrica).valor_contratao,
                            "valor_unitario",First(fabrica).valor_unitario,
                            "co_area",First(fabrica).co_area,
                            "co_lider_area",First(fabrica).co_lider_area,
                            "no_area",First(fabrica).no_area,
                            "co_lider_area_gestor",First(fabrica).co_lider_area_gestor,
                            "id_sequencial",First(fabrica).id_sequencial,
                            "id_fornecedor",First(fabrica).id_fornecedor
                    )
                )
            ,
                UpdateContext({vShowValidacao:true})
            );
            
            //UpdateContext({vShowMensalizacao:true})
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =21.08
        Text: ="+"
        Visible: =!vEdicaoItem
        Width: =52
        X: =1846
        Y: =378
        ZIndex: =43

    Rectangle1 As rectangle:
        Fill: =varCorVermelho
        Height: =47
        Width: =1749
        X: =140
        Y: =445
        ZIndex: =44

    Group8 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =44

        Label2_11 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =45
            PaddingLeft: =0
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: |-
                ="Qtde
                Horas"
            Width: =153.21
            X: =1051
            Y: =335
            ZIndex: =36

        txt_qtd_horas As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =vAllitems.qtd_meses
            Font: =Font.Lato
            Format: =TextFormat.Number
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =15
            Width: =132.12
            X: =1063
            Y: =380
            ZIndex: =37

    Label2_8 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: ="ID Fábrica"
        Width: =139
        X: =140
        Y: =445
        ZIndex: =45

    Label2_15 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: ="Descrição TI "
        Width: =589
        X: =279
        Y: =445
        ZIndex: =46

    Label2_16 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: ="Ano Consumo"
        Width: =90
        X: =868
        Y: =445
        ZIndex: =47

    Label2_17 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: |-
            ="Mês
            Início"
        Width: =90
        X: =969
        Y: =445
        ZIndex: =48

    Label2_18 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: |-
            ="Qtde
            Meses"
        Width: =90
        X: =1061
        Y: =445
        ZIndex: =49

    Group3_7 As group:
        Height: =5
        Width: =5
        X: =20
        Y: =20
        ZIndex: =49

        cmb_modelo_tarifacao As combobox:
            BorderColor: =RGBA(128, 128, 128, 1)
            ChevronBackground: =RGBA(0, 0, 0, 0)
            ChevronFill: =RGBA(39, 113, 194, 1)
            DefaultSelectedItems: =[vAllitems.id]
            DisplayFields: =["no_modelo"]
            Font: =Font.Lato
            InputTextPlaceholder: =""
            Items: =clc_modelo_tarifacao
            PaddingLeft: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            SearchFields: =["no_modelo"]
            SearchItems: =Search(clc_modelo_tarifacao,cmb_modelo_tarifacao.SearchText,"no_modelo")
            SelectMultiple: =false
            Size: =18.27
            Width: =195
            X: =1360
            Y: =380
            ZIndex: =39

        Label2_13 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =45
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: ="Modelo Tarifação"
            Width: =164.45
            X: =1361
            Y: =334
            ZIndex: =40

    Label2_19 As label:
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: ="Total Baseline"
        Width: =183
        X: =1177
        Y: =445
        ZIndex: =50

    Label2_20 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: ="Valor Contratado"
        Width: =271
        X: =1360
        Y: =445
        ZIndex: =51

    Label2_21 As label:
        Align: =Align.Center
        Color: =RGBA(255, 255, 255, 1)
        Font: =Font.Lato
        FontWeight: =FontWeight.Semibold
        Height: =47
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =12
        Text: ="Valor Unitário"
        Width: =258
        X: =1631
        Y: =445
        ZIndex: =52

    btnAdd_5 As button:
        Fill: =RGBA(255, 0, 0, 1)
        FontWeight: =FontWeight.Bold
        Height: =46
        OnSelect: |-
            =UpdateContext({vValidacao:true});
            
            If(IsBlank(cmb_id_fabrica.Selected.id_fabrica),UpdateContext({vValidacao:false}));
            If(IsBlank(txt_descricao.Text),UpdateContext({vValidacao:false}));
            If(IsBlank(cmb_ano_consumo.Selected.ano),UpdateContext({vValidacao:false}));
            If(IsBlank(cmb_mes_consumo.Selected.mes),UpdateContext({vValidacao:false}));
            If(IsBlank(txt_qtd_horas.Text),UpdateContext({vValidacao:false}));
            If(IsBlank(cmb_modelo_tarifacao.Selected.no_modelo),UpdateContext({vValidacao:false}));
            If(IsBlank(txt_valor_periodo.Text),UpdateContext({vValidacao:false}));
            
            If(vValidacao=true,
            
                Patch(clc_tabela1,
                    Defaults(clc_tabela1),
                    {
                        id: Last( SortByColumns( clc_tabela1, "id", SortOrder.Ascending )).id + 1,
                        id_fabrica: cmb_id_fabrica.Selected.id_fabrica,
                        descricao: txt_descricao.Text,
                        ano_consumo: cmb_ano_consumo.Selected.ano,
                        mes_inicio: cmb_mes_consumo.Selected.mes,
                        qtd_meses: Value(txt_qtd_horas.Text),
                        total_baseline: txt_baseline.Text,
                        valor_contratao: txt_valor_periodo.Text,
                        valor_unitario: Value(txt_valor_periodo.Text) / Value(txt_qtd_horas.Text)
                    }
                );
            
                Clear(clc_group_msl);
                ClearCollect(clc_group_msl,
                    AddColumns(
                            GroupBy(clc_tabela1, "id_fabrica","fabrica"),
                            "id",First(fabrica).id,
                            "descricao",First(fabrica).descricao,
                            "ano_consumo",First(fabrica).ano_consumo,
                            "mes_inicio",First(fabrica).mes_inicio,
                            "qtd_meses",First(fabrica).qtd_meses,
                            "total_baseline",First(fabrica).total_baseline,
                            "valor_contratao",First(fabrica).valor_contratao,
                            "valor_unitario",First(fabrica).valor_unitario
                    )
                )
            ,
                UpdateContext({vShowValidacao:true})
            );
            
            //UpdateContext({vShowMensalizacao:true})
        PaddingRight: =7.03
        PaddingTop: =7.03
        Size: =21.08
        Text: ="Salvar"
        Visible: =!vEdicaoItem
        Width: =254
        X: =1631
        Y: =1010
        ZIndex: =57

    imagem_header_1 As imagem_header:
        Height: =74
        Width: =375
        X: =1545
        Y: =12
        ZIndex: =58

    gp_mensalização As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =90

        fundo_modal As rectangle:
            Fill: =RGBA(245, 245, 245, 0.8)
            Height: =1080
            Visible: =vShowMensalizacao
            Width: =1920
            ZIndex: =76

        Rectangle5 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =390
            Visible: =vShowMensalizacao
            Width: =1754.14
            X: =127
            Y: =298
            ZIndex: =77

        Label4 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =28.11
            Text: ="Mensalização"
            Visible: =vShowMensalizacao
            Width: =281.11
            X: =172
            Y: =317
            ZIndex: =78

        Label5 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: |-
                ="Id Fábrica:"
            Visible: =vShowMensalizacao
            Width: =168.67
            X: =178
            Y: =372
            ZIndex: =79

        Label5_1 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: |-
                ="Total Baseline:"
            Visible: =vShowMensalizacao
            Width: =210.83
            X: =530
            Y: =372
            ZIndex: =80

        Label5_2 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =43
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: |-
                ="Ano:"
            Visible: =vShowMensalizacao
            Width: =101.2
            X: =939
            Y: =372
            ZIndex: =81

        Label5_3 As label:
            Font: =Font.Lato
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: =vLinhaSelecionada.id_fabrica
            Visible: =vShowMensalizacao
            Width: =168.67
            X: =328
            Y: =372
            ZIndex: =82

        Label5_4 As label:
            Font: =Font.Lato
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: =vLinhaSelecionada.ano_consumo
            Visible: =vShowMensalizacao
            Width: =168.67
            X: =1024
            Y: =372
            ZIndex: =83

        Label5_5 As label:
            Font: =Font.Lato
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: =vLinhaSelecionada.total_baseline
            Visible: =vShowMensalizacao
            Width: =168.67
            X: =734
            Y: =372
            ZIndex: =84

        Label5_6 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =45
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: |-
                ="Descrição TI:"
            Visible: =vShowMensalizacao
            Width: =188.35
            X: =178
            Y: =422
            ZIndex: =85

        Label5_7 As label:
            Font: =Font.Lato
            Height: =45
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: =vLinhaSelecionada.descricao
            Visible: =vShowMensalizacao
            Width: =1468
            X: =372
            Y: =422
            ZIndex: =86

        Label6 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingLeft: =25
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Janeiro"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =197
            Y: =488
            ZIndex: =87

        Label6_1 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingLeft: =15
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Fevereiro"
            Visible: =vShowMensalizacao
            Width: =145
            X: =338
            Y: =488
            ZIndex: =88

        Label6_2 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingLeft: =15
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Março"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =483
            Y: =488
            ZIndex: =89

        Label6_3 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Abril"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =623
            Y: =488
            ZIndex: =90

        Label6_4 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Maio"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =752
            Y: =488
            ZIndex: =91

        Label6_5 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Junho"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =877
            Y: =488
            ZIndex: =92

        Label6_6 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Julho"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =1010
            Y: =488
            ZIndex: =93

        Label6_7 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Agosto"
            Visible: =vShowMensalizacao
            X: =1117
            Y: =488
            ZIndex: =94

        Label6_8 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Setembro"
            Visible: =vShowMensalizacao
            X: =1241
            Y: =488
            ZIndex: =95

        Label6_9 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Outubro"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =1383
            Y: =488
            ZIndex: =96

        Label6_10 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Novembro"
            Visible: =vShowMensalizacao
            Width: =158.83
            X: =1499
            Y: =488
            ZIndex: =97

        Label6_11 As label:
            Color: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Text: ="Dezembro"
            Visible: =vShowMensalizacao
            Width: =140.56
            X: =1639
            Y: =488
            ZIndex: =98

        txtJan As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =215
            Y: =545
            ZIndex: =99

        txtFev As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =343
            Y: =545
            ZIndex: =100

        txtMar As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =473
            Y: =545
            ZIndex: =101

        txtAbr As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =601
            Y: =545
            ZIndex: =102

        txtMai As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =730
            Y: =545
            ZIndex: =103

        txtJun As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =857
            Y: =545
            ZIndex: =104

        txtJul As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =986
            Y: =545
            ZIndex: =105

        txtAgo As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =1113
            Y: =545
            ZIndex: =106

        txtSet As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =1249
            Y: =545
            ZIndex: =107

        txtOut As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =1378
            Y: =545
            ZIndex: =108

        txtNov As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =1508
            Y: =545
            ZIndex: =109

        txtDez As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =35
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowMensalizacao
            Width: =120
            X: =1636
            Y: =545
            ZIndex: =110

        Button1 As button:
            Fill: =RGBA(255, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#FF0000")
            OnSelect: |-
                =Clear(clc_mensalizacao);
                ClearCollect(clc_mensalizacao,
                {
                    id:
                }
                );
                
                UpdateContext({vShowMensalizacao:false})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Salvar"
            Visible: =vShowMensalizacao
            Width: =224.89
            X: =1305
            Y: =622
            ZIndex: =111

        Button1_1 As button:
            BorderColor: |
                =ColorValue("#FF0000")
            BorderThickness: =1
            Color: =RGBA(255, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            HoverColor: =RGBA(255, 0, 0, 1)
            HoverFill: =
            OnSelect: |-
                =UpdateContext({vShowMensalizacao:false})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Cancelar"
            Visible: =vShowMensalizacao
            Width: =224.89
            X: =1555
            Y: =622
            ZIndex: =112

    Group2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =122

        Label2_14 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            PaddingLeft: =0
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: ="Valor do Período"
            Width: =276.9
            X: =1554
            Y: =337
            ZIndex: =41

        lbl_txt_valor_periodo As label:
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.Lato
            Height: =35
            PaddingLeft: =12
            Text: |-
                =Text(Value(txt_valor_periodo.Text),"$#,##0.00","pt-BR")
            Width: =263
            X: =1567
            Y: =382
            ZIndex: =60

        txt_valor_periodo As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(0, 0, 0, 0)
            Default: =vAllitems.valor_contratao
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Lato
            Format: =TextFormat.Number
            HintText: ="R$"
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =15
            Width: =264.25
            X: =1567
            Y: =380
            ZIndex: =61

    Group7 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =123

        Label2_12 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Semibold
            Height: =46
            PaddingLeft: =0
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =14
            Text: ="Baseline Produto"
            Width: =153.21
            X: =1202
            Y: =334
            ZIndex: =38

        lblBaseline As label:
            Fill: =RGBA(255, 255, 255, 1)
            Font: =Font.Lato
            Size: =15
            Text: |-
                =Text(Value(txt_baseline.Text),"#,##0","pt-BR")
            X: =1202
            Y: =380
            ZIndex: =62

        txt_baseline As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(0, 0, 0, 0)
            Default: =vAllitems.total_baseline
            Fill: =RGBA(0, 0, 0, 0)
            Font: =Font.Lato
            Format: =TextFormat.Number
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =15
            Width: =150
            X: =1202
            Y: =380
            ZIndex: =63

    gp_conf_exclusao As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =127

        fundo_modal_9 As rectangle:
            Fill: =RGBA(245, 245, 245, 0.8)
            Height: =1080
            Visible: =vShowConfExclusaoItem
            Width: =1920
            ZIndex: =64

        Rectangle5_9 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =390
            Visible: =vShowConfExclusaoItem
            Width: =1754.14
            X: =118
            Y: =271
            ZIndex: =65

        Label4_9 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =28.11
            Text: ="Atenção"
            Visible: =vShowConfExclusaoItem
            Width: =639.53
            X: =163
            Y: =290
            ZIndex: =66

        Label5_54 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =63
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Tem certeza de que deseja excluir o item selecionado?"
            Visible: =vShowConfExclusaoItem
            Width: =1755
            X: =112
            Y: =429
            ZIndex: =67

        btn_canc_exc As button:
            Fill: =RGBA(255, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#FF0000")
            OnSelect: |-
                =UpdateContext({vShowConfExclusaoItem:false})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Cancelar"
            Visible: =vShowConfExclusaoItem
            Width: =224.89
            X: =1021
            Y: =594
            ZIndex: =68

        btn_conf_exc As button:
            Color: =RGBA(166, 166, 166, 1)
            Fill: =RGBA(255, 255, 255, 1)
            HoverFill: |-
                =ColorValue("#A6A6A6")
            OnSelect: |-
                =RemoveIf(
                    clc_tabela1,id =Value(id_sel)
                );
                
                    Clear(clc_group_msl);
                    ClearCollect(clc_group_msl,
                        AddColumns(
                                GroupBy(clc_tabela1, "id_fabrica","fabrica"),
                                "id",First(fabrica).id,
                                "descricao",First(fabrica).descricao,
                                "ano_consumo",First(fabrica).ano_consumo,
                                "mes_inicio",First(fabrica).mes_inicio,
                                "qtd_meses",First(fabrica).qtd_meses,
                                "total_baseline",First(fabrica).total_baseline,
                                "valor_contratao",First(fabrica).valor_contratao,
                                "valor_unitario",First(fabrica).valor_unitario,
                                "co_area",First(fabrica).co_area,
                                "co_lider_area",First(fabrica).co_lider_area,
                                "no_area",First(fabrica).no_area,
                                "co_lider_area_gestor",First(fabrica).co_lider_area_gestor,
                                "id_sequencial",First(fabrica).id_sequencial,
                                "id_fornecedor",First(fabrica).id_fornecedor
                        )
                    );
                UpdateContext({vShowConfExclusaoItem: false,id_sel: Blank()})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Confirmar"
            Visible: =vShowConfExclusaoItem
            Width: =224.89
            X: =759
            Y: =593
            ZIndex: =69

        Icon4 As icon.More:
            Color: =RGBA(255, 255, 0, 1)
            Height: =130
            Icon: =Icon.Warning
            Visible: =vShowConfExclusaoItem
            Width: =208
            X: =882
            Y: =309
            ZIndex: =70

    gp_validaçao As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =127

        fundo_modal_1 As rectangle:
            Fill: =RGBA(245, 245, 245, 0.8)
            Height: =1080
            Visible: =vShowValidacao
            Width: =1920
            ZIndex: =71

        Rectangle5_1 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =390
            Visible: =vShowValidacao
            Width: =1754.14
            X: =118
            Y: =271
            ZIndex: =72

        Label4_1 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =28.11
            Text: ="Erro"
            Visible: =vShowValidacao
            Width: =639.53
            X: =163
            Y: =290
            ZIndex: =73

        Label5_15 As label:
            Align: =Align.Center
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =63
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Todos os campos são obrigatórios"
            Visible: =vShowValidacao
            Width: =1755
            X: =112
            Y: =429
            ZIndex: =74

        Button1_3 As button:
            Fill: =RGBA(255, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#FF0000")
            OnSelect: |-
                =UpdateContext({vShowValidacao:false})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Fechar"
            Visible: =vShowValidacao
            Width: =224.89
            X: =867
            Y: =601
            ZIndex: =75

    btnEditar As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =144

        btnAdd_3 As button:
            Fill: =RGBA(54, 176, 75, 1)
            FontWeight: =FontWeight.Bold
            Height: =32
            OnSelect: |-
                =UpdateIf(clc_tabela1, id=vAllitems.id And id_fabrica=vAllitems.id_fabrica,{
                        id_fabrica: If(!IsBlank(cmb_id_fabrica.Selected.id_fabrica),cmb_id_fabrica.Selected.id_fabrica, vAllitems.id_fabrica),
                        descricao: If(!IsBlank(txt_descricao.Text),txt_descricao.Text, vAllitems.descricao),
                        ano_consumo: If(!IsBlank(cmb_ano_consumo.Selected.ano),cmb_ano_consumo.Selected.ano, vAllitems.ano_consumo) ,
                        mes_inicio: If(!IsBlank(cmb_mes_consumo.Selected.mes),cmb_mes_consumo.Selected.mes, vAllitems.mes_inicio) ,
                        qtd_meses: If(!IsBlank(Value(txt_qtd_horas.Text)), Value(txt_qtd_horas.Text), vAllitems.qtd_meses),
                        total_baseline: If(!IsBlank(txt_baseline.Text),txt_baseline.Text, vAllitems.total_baseline),
                        valor_contratao: If(!IsBlank(Value(txt_valor_periodo.Text)),Value(txt_valor_periodo.Text), vAllitems.valor_contratao),
                        valor_unitario: If(!IsBlank(Value(txt_valor_periodo.Text)),Value(txt_valor_periodo.Text), vAllitems.valor_contratao) / If(!IsBlank(Value(txt_qtd_horas.Text)), Value(txt_qtd_horas.Text), vAllitems.qtd_meses)
                });
                UpdateContext({vEdicaoItem:false, vAllitems:Blank()});
                Reset(cmb_id_fabrica);
                Reset(txt_descricao);
                Reset(cmb_ano_consumo);
                Reset(cmb_mes_consumo);
                Reset(txt_qtd_horas);
                Reset(cmb_modelo_tarifacao);
                Reset(txt_valor_periodo);
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: =""
            Visible: =vEdicaoItem
            Width: =32
            X: =1840
            Y: =382
            ZIndex: =53

        Icon3 As icon.CheckBadge:
            Color: =RGBA(255, 255, 255, 1)
            Height: =22
            Icon: =Icon.CheckBadge
            OnSelect: |-
                =UpdateIf(clc_tabela1, id=vAllitems.id And id_fabrica=vAllitems.id_fabrica,{
                        id_fabrica: If(!IsBlank(cmb_id_fabrica.Selected.id_fabrica),cmb_id_fabrica.Selected.id_fabrica, vAllitems.id_fabrica),
                        descricao: If(!IsBlank(txt_descricao.Text),txt_descricao.Text, vAllitems.descricao),
                        ano_consumo: If(!IsBlank(cmb_ano_consumo.Selected.ano),cmb_ano_consumo.Selected.ano, vAllitems.ano_consumo) ,
                        mes_inicio: If(!IsBlank(cmb_mes_consumo.Selected.mes),cmb_mes_consumo.Selected.mes, vAllitems.mes_inicio) ,
                        qtd_meses: If(!IsBlank(Value(txt_qtd_horas.Text)), Value(txt_qtd_horas.Text), vAllitems.qtd_meses),
                        total_baseline: If(!IsBlank(txt_baseline.Text),txt_baseline.Text, vAllitems.total_baseline),
                        valor_contratao: If(!IsBlank(Value(txt_valor_periodo.Text)),Value(txt_valor_periodo.Text), vAllitems.valor_contratao),
                        valor_unitario: If(!IsBlank(Value(txt_valor_periodo.Text)),Value(txt_valor_periodo.Text), vAllitems.valor_contratao) / If(!IsBlank(Value(txt_qtd_horas.Text)), Value(txt_qtd_horas.Text), vAllitems.qtd_meses)
                });
                UpdateContext({vEdicaoItem:false, vAllitems:Blank()});
                Reset(cmb_id_fabrica);
                Reset(txt_descricao);
                Reset(cmb_ano_consumo);
                Reset(cmb_mes_consumo);
                Reset(txt_qtd_horas);
                Reset(cmb_modelo_tarifacao);
                Reset(txt_valor_periodo);
            Visible: =vEdicaoItem
            Width: =22
            X: =1845
            Y: =387
            ZIndex: =54

    BtnCancel As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =146

        btnAdd_4 As button:
            Fill: =RGBA(255, 0, 0, 1)
            FontWeight: =FontWeight.Bold
            Height: =32
            OnSelect: |-
                =UpdateContext({vEdicaoItem:false, vAllitems:Blank()});
                Reset(cmb_id_fabrica);
                Reset(txt_descricao);
                Reset(cmb_ano_consumo);
                Reset(cmb_mes_consumo);
                Reset(txt_qtd_horas);
                Reset(cmb_modelo_tarifacao);
                Reset(txt_valor_periodo);
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: =""
            Visible: =vEdicaoItem
            Width: =32
            X: =1881
            Y: =382
            ZIndex: =55

        Icon3_3 As icon.CheckBadge:
            Color: =RGBA(255, 255, 255, 1)
            Height: =22
            Icon: =Icon.CancelBadge
            OnSelect: |-
                =UpdateContext({vEdicaoItem:false, vAllitems:Blank()});
                Reset(cmb_id_fabrica);
                Reset(txt_descricao);
                Reset(cmb_ano_consumo);
                Reset(cmb_mes_consumo);
                Reset(txt_qtd_horas);
                Reset(cmb_modelo_tarifacao);
                Reset(txt_valor_periodo);
            Visible: =vEdicaoItem
            Width: =22
            X: =1886
            Y: =387
            ZIndex: =56

    "'gp_add-Fabrica' As group":
        Height: =5
        Width: =5
        X: =40
        Y: =20
        ZIndex: =174

        fundo_modal_2 As rectangle:
            Fill: =RGBA(245, 245, 245, 0.8)
            Height: =1080
            Visible: =vShowAddFabrica
            Width: =1920
            ZIndex: =113

        Rectangle5_2 As rectangle:
            BorderColor: =RGBA(255, 255, 255, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =390
            Visible: =vShowAddFabrica
            Width: =702
            X: =637
            Y: =176
            ZIndex: =114

        Label4_2 As label:
            Color: =RGBA(255, 0, 0, 1)
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =28.11
            Text: ="Nova Fábrica"
            Visible: =vShowAddFabrica
            Width: =281.11
            X: =682
            Y: =195
            ZIndex: =115

        Label5_23 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =42
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: |-
                ="Id Fábrica:"
            Visible: =vShowAddFabrica
            Width: =168.67
            X: =688
            Y: =250
            ZIndex: =116

        Label5_17 As label:
            Font: =Font.Lato
            FontWeight: =FontWeight.Bold
            Height: =45
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: |-
                ="Descrição:"
            Visible: =vShowAddFabrica
            Width: =188.35
            X: =690
            Y: =310
            ZIndex: =117

        TextInput2_17 As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowAddFabrica
            Width: =360
            X: =837
            Y: =258
            ZIndex: =118

        TextInput2_18 As text:
            BorderColor: =RGBA(128, 128, 128, 1)
            Default: =""
            Height: =120
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =18.27
            Visible: =vShowAddFabrica
            Width: =358
            X: =839
            Y: =318
            ZIndex: =119

        Button1_5 As button:
            Fill: =RGBA(255, 0, 0, 1)
            HoverFill: |-
                =ColorValue("#FF0000")
            OnSelect: |-
                =Patch(clc_fabrica,
                    Defaults(clc_fabrica),
                    {
                        id: Last( SortByColumns( clc_fabrica, "id", SortOrder.Descending )).id,
                        id_fabrica: TextInput2_17.Text
                    }
                );
                //Refresh(clc_fabrica);;
                UpdateContext({vShowAddFabrica:false})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Salvar"
            Visible: =vShowAddFabrica
            Width: =224.89
            X: =723
            Y: =475
            ZIndex: =120

        Button1_4 As button:
            BorderColor: |
                =ColorValue("#FF0000")
            BorderThickness: =1
            Color: =RGBA(255, 0, 0, 1)
            Fill: =RGBA(255, 255, 255, 1)
            HoverColor: =RGBA(255, 0, 0, 1)
            HoverFill: =
            OnSelect: |-
                =UpdateContext({vShowAddFabrica:false})
            PaddingRight: =7.03
            PaddingTop: =7.03
            Size: =21.08
            Text: ="Cancelar"
            Visible: =vShowAddFabrica
            Width: =224.89
            X: =973
            Y: =475
            ZIndex: =121

